import tkinter as tk
from tkinter import filedialog, messagebox
from PIL import Image, ImageTk
import re

def is_email(text):
    return re.match(r"[^@]+@[^@]+\.[^@]+", text)

def separate_file(input_file, output_file, separator):
    with open(input_file, "r", encoding="utf-8") as f:
        lines = f.readlines()

    separated = []
    for line in lines:
        if separator in line:
            parts = line.strip().split(separator)
            if is_email(parts[0]):
                separated.append(separator.join(parts))

    with open(output_file, "w", encoding="utf-8") as f:
        f.write("\n".join(separated))
    messagebox.showinfo("Done", f"Processed {len(separated)} lines!")

def select_input():
    filename = filedialog.askopenfilename()
    input_entry.delete(0, tk.END)
    input_entry.insert(0, filename)

def select_output():
    filename = filedialog.asksaveasfilename(defaultextension=".txt")
    output_entry.delete(0, tk.END)
    output_entry.insert(0, filename)

def run_separator():
    separate_file(input_entry.get(), output_entry.get(), sep_entry.get())

# GUI Window
root = tk.Tk()
root.title("SEPARATOR Tool")

# Load 3D Galaxy Background
bg_image = Image.open("galaxy_3d.jpg")  # <-- Put your galaxy image in the same folder
bg_photo = ImageTk.PhotoImage(bg_image)
bg_label = tk.Label(root, image=bg_photo)
bg_label.place(relwidth=1, relheight=1)

# Input Fields
tk.Label(root, text="Input File:", bg="#000000", fg="white").place(x=20, y=20)
input_entry = tk.Entry(root, width=40)
input_entry.place(x=120, y=20)
tk.Button(root, text="Browse", command=select_input).place(x=400, y=16)

tk.Label(root, text="Output File:", bg="#000000", fg="white").place(x=20, y=60)
output_entry = tk.Entry(root, width=40)
output_entry.place(x=120, y=60)
tk.Button(root, text="Save As", command=select_output).place(x=400, y=56)

tk.Label(root, text="Separator:", bg="#000000", fg="white").place(x=20, y=100)
sep_entry = tk.Entry(root, width=5)
sep_entry.insert(0, ":")
sep_entry.place(x=120, y=100)

tk.Button(root, text="Run Separator", command=run_separator, bg="#FF6600", fg="white").place(x=150, y=140)

root.geometry("500x200")
root.mainloop()