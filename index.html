<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ML Account Selector - Feithan</title>
<style>
    body { font-family: Arial, sans-serif; background-color: #1e1e2f; color: #f0f0f0; padding: 20px; }
    h1 { color: #ffcc00; }
    button { padding: 10px 20px; margin: 10px 0; cursor: pointer; }
    input[type=file] { margin: 10px 0; }
    #account-list, #selected-list, #v2lno-list { margin-top: 20px; max-height: 300px; overflow-y: auto; border: 1px solid #444; padding: 10px; }
    .account-line { padding: 2px 0; border-bottom: 1px solid #333; }
</style>
</head>
<body>

<h1>ML Account Selector</h1>
<p>Created by: Feithan | TG: @FeithanNotGz</p>

<input type="file" id="fileInput" accept=".txt">
<br>
<label>Number to select:</label>
<input type="number" id="numSelect" min="1" value="5">
<br>
<button onclick="selectAccounts()">Select Accounts</button>

<div id="account-list"></div>
<div id="selected-list"></div>
<div id="v2lno-list"></div>

<button id="downloadSelectedBtn" style="display:none;" onclick="downloadSelected()">Download Selected</button>
<button id="downloadV2LNoBtn" style="display:none;" onclick="downloadV2LNo()">Download V2L: No</button>

<script>
let accounts = [];
let selectedAccounts = [];
let v2lNoAccounts = [];

document.getElementById('fileInput').addEventListener('change', function(e){
    const file = e.target.files[0];
    if(!file) return;
    const reader = new FileReader();
    reader.onload = function(evt) {
        accounts = evt.target.result.split(/\r?\n/).filter(line => line.trim() !== '');
        displayAccounts();
    }
    reader.readAsText(file);
});

function displayAccounts() {
    const listDiv = document.getElementById('account-list');
    listDiv.innerHTML = "<h3>All Accounts:</h3>";
    accounts.forEach(acc => {
        const div = document.createElement('div');
        div.className = 'account-line';
        div.textContent = acc;
        listDiv.appendChild(div);
    });
}

function selectAccounts() {
    const numToSelect = parseInt(document.getElementById('numSelect').value);
    if(numToSelect > accounts.length) {
        alert("Number to select exceeds total accounts!");
        return;
    }

    selectedAccounts = [];
    v2lNoAccounts = [];

    // Shuffle accounts randomly
    const shuffled = [...accounts].sort(() => Math.random() - 0.5);

    // Separate V2L: No accounts
    shuffled.forEach(acc => {
        if(acc.toUpperCase().includes("V2L: NO")) {
            v2lNoAccounts.push(acc);
        }
    });

    // Select accounts excluding V2L: No
    const filtered = shuffled.filter(acc => !acc.toUpperCase().includes("V2L: NO"));
    selectedAccounts = filtered.slice(0, numToSelect);

    // Display selected accounts
    const selectedDiv = document.getElementById('selected-list');
    selectedDiv.innerHTML = "<h3>Selected Accounts:</h3>";
    selectedAccounts.forEach(acc => {
        const div = document.createElement('div');
        div.className = 'account-line';
        div.textContent = acc;
        selectedDiv.appendChild(div);
    });

    // Display V2L: No accounts
    const v2lDiv = document.getElementById('v2lno-list');
    v2lDiv.innerHTML = "<h3>V2L: No Accounts:</h3>";
    v2lNoAccounts.forEach(acc => {
        const div = document.createElement('div');
        div.className = 'account-line';
        div.textContent = acc;
        v2lDiv.appendChild(div);
    });

    // Show download buttons
    document.getElementById('downloadSelectedBtn').style.display = 'inline-block';
    document.getElementById('downloadV2LNoBtn').style.display = v2lNoAccounts.length > 0 ? 'inline-block' : 'none';
}

function downloadSelected() {
    const blob = new Blob([selectedAccounts.join('\n')], {type: "text/plain"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = "selected_accounts.txt";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}

function downloadV2LNo() {
    const blob = new Blob([v2lNoAccounts.join('\n')], {type: "text/plain"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = "V2L_No_accounts.txt";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}
</script>

</body>
</html>
